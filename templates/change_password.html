{% extends "base.html" %}

{% block title %}Passwort ändern – Studiennavigator{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
{% endblock %}

{% block body_class %} class="auth"{% endblock %}

{% block content %}
<main class="auth-card">
  <h1>Passwort ändern</h1>

  <!-- Flash Messages -->
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      <div class="flash-messages">
        {% for category, message in messages %}
          <div class="flash-message flash-{{ category }}">
            {{ message }}
            <button type="button" class="flash-close" onclick="this.parentElement.style.display='none'">&times;</button>
          </div>
        {% endfor %}
      </div>
    {% endif %}
  {% endwith %}

  <form method="post" action="{{ url_for('change_password') }}" id="change-password-form">
    <div class="form-group">
      <label for="old_password">Aktuelles Passwort</label>
      <input type="password" id="old_password" name="old_password" required autofocus>
    </div>

    <div class="form-group">
      <label for="new_password">Neues Passwort</label>
      <input type="password" id="new_password" name="new_password" required
             minlength="12" maxlength="128">
      <small class="form-text">Mindestens 12 Zeichen, inkl. Groß-/Kleinbuchstaben, Ziffern und Sonderzeichen</small>
    </div>

    <div class="form-group">
      <label for="confirm_password">Neues Passwort wiederholen</label>
      <input type="password" id="confirm_password" name="confirm_password" required
             minlength="12" maxlength="128">
    </div>

    <button type="submit" id="change-btn">Passwort ändern</button>
  </form>

  <p class="muted" style="margin-top: 1rem;">
    <a href="{{ url_for('logout') }}">Abmelden</a>
  </p>
</main>
{% endblock %}


{% block extra_js %}
<script src="{{ url_for('static', filename='login_validation.js') }}" defer></script>
{% endblock %}